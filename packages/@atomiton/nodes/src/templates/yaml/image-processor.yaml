id: "550e8400-e29b-41d4-a716-446655440003"
name: "Image Processing Workflow"
description: "Batch process images with parallel operations for optimal performance"
category: "media"
type: "group"
version: "1.0.0"

metadata:
  created: "2025-01-15T00:00:00Z"
  modified: "2025-01-15T00:00:00Z"
  author: "Atomiton Team"
  authorId: "atomiton-team"
  source: "system"
  type: "image-processing-workflow"
  icon: "image"
  tags:
    - "image"
    - "processing"
    - "media"
  keywords:
    - "image"
    - "photo"
    - "resize"
    - "watermark"
    - "batch"
    - "processing"
    - "media"
    - "parallel"
    - "jpg"
    - "png"
    - "gif"
  runtime:
    language: "typescript"
  experimental: false
  deprecated: false
  documentationUrl: "https://docs.atomiton.com/nodes/image-processor"

nodes:
  - id: "image-source"
    type: "file-system"
    name: "List Images"
    category: "io"
    version: "1.0.0"

    metadata:
      id: "file-system"
      name: "File System"
      type: "file-system"
      version: "1.0.0"
      author: "Atomiton Core Team"
      description: "File system operations (read, write, list)"
      category: "io"
      icon: "file"
      source: "system"
      experimental: false
      deprecated: false

    inputPorts:
      - id: "trigger"
        name: "Trigger"
        type: "trigger"
        dataType: "any"
        required: false

    outputPorts:
      - id: "output"
        name: "Output"
        type: "output"
        dataType: "any"
      - id: "error"
        name: "Error"
        type: "error"
        dataType: "object"

    parameters:
      operation:
        type: "string"
        default: "read"
        control: "select"
        options: ["read", "write", "list", "delete", "exists"]
      filePath:
        type: "string"
        required: true
        control: "file-picker"
      pattern:
        type: "string"
        default: "*"
        control: "text"
      recursive:
        type: "boolean"
        default: false
        control: "checkbox"
      includeStats:
        type: "boolean"
        default: false
        control: "checkbox"

    data:
      operation: "list"
      filePath: "/images/input"
      pattern: "*.{jpg,png,gif}"
      recursive: false
      includeStats: true
      customLabel: "List Images"
      lastModified: "2025-01-15T10:00:00Z"

    position:
      x: 50
      y: 150

    settings:
      ui:
        position:
          x: 50
          y: 150

  - id: "image-loop"
    type: "loop"
    name: "Process Each Image"
    category: "logic"
    version: "1.0.0"

    metadata:
      id: "loop"
      name: "Loop"
      type: "loop"
      version: "1.0.0"
      author: "Atomiton Core Team"
      description: "Iterate over arrays or collections"
      category: "logic"
      icon: "git-branch"
      source: "system"
      experimental: false
      deprecated: false

    inputPorts:
      - id: "input"
        name: "Input"
        type: "input"
        dataType: "array"
        required: true

    outputPorts:
      - id: "item"
        name: "Item"
        type: "output"
        dataType: "any"
      - id: "index"
        name: "Index"
        type: "output"
        dataType: "number"
      - id: "complete"
        name: "Complete"
        type: "output"
        dataType: "array"

    parameters:
      iterateOver:
        type: "string"
        default: "items"
        control: "text"
      maxIterations:
        type: "number"
        default: 1000
        control: "number"
      breakOnError:
        type: "boolean"
        default: false
        control: "checkbox"

    data:
      iterateOver: "files"
      maxIterations: 1000
      breakOnError: false
      customLabel: "Process Each Image"
      lastModified: "2025-01-15T10:00:00Z"

    position:
      x: 250
      y: 150

    settings:
      ui:
        position:
          x: 250
          y: 150

  - id: "parallel-processor"
    type: "parallel"
    name: "Parallel Processing"
    category: "logic"
    version: "1.0.0"

    metadata:
      id: "parallel"
      name: "Parallel"
      type: "parallel"
      version: "1.0.0"
      author: "Atomiton Core Team"
      description: "Execute multiple operations in parallel"
      category: "logic"
      icon: "zap"
      source: "system"
      experimental: false
      deprecated: false

    inputPorts:
      - id: "input"
        name: "Input"
        type: "input"
        dataType: "any"
        required: true

    outputPorts:
      - id: "output"
        name: "Output"
        type: "output"
        dataType: "array"

    parameters:
      concurrency:
        type: "number"
        default: 4
        control: "number"
      preserveOrder:
        type: "boolean"
        default: true
        control: "checkbox"
      timeout:
        type: "number"
        default: 30000
        control: "number"

    data:
      concurrency: 4
      preserveOrder: true
      timeout: 30000
      customLabel: "Parallel Processing"
      lastModified: "2025-01-15T10:00:00Z"

    position:
      x: 450
      y: 150

    settings:
      ui:
        position:
          x: 450
          y: 150

  - id: "image-resize"
    type: "image-composite"
    name: "Resize Image"
    category: "media"
    version: "1.0.0"

    metadata:
      id: "image-composite"
      name: "Image Composite"
      type: "image-composite"
      version: "1.0.0"
      author: "Atomiton Core Team"
      description: "Image processing and manipulation"
      category: "media"
      icon: "image"
      source: "system"
      experimental: false
      deprecated: false

    inputPorts:
      - id: "input"
        name: "Input"
        type: "input"
        dataType: "buffer"
        required: true

    outputPorts:
      - id: "output"
        name: "Output"
        type: "output"
        dataType: "buffer"
      - id: "metadata"
        name: "Metadata"
        type: "output"
        dataType: "object"

    parameters:
      operation:
        type: "string"
        default: "resize"
        control: "select"
        options: ["resize", "crop", "rotate", "flip", "watermark", "filter"]
      width:
        type: "number"
        default: 800
        control: "number"
      height:
        type: "number"
        default: 600
        control: "number"
      maintainAspectRatio:
        type: "boolean"
        default: true
        control: "checkbox"
      quality:
        type: "number"
        default: 85
        control: "range"
        min: 1
        max: 100
      format:
        type: "string"
        default: "jpeg"
        control: "select"
        options: ["jpeg", "png", "webp", "avif"]

    data:
      operation: "resize"
      width: 800
      height: 600
      maintainAspectRatio: true
      quality: 85
      format: "jpeg"
      customLabel: "Resize Image"
      lastModified: "2025-01-15T10:00:00Z"

    position:
      x: 650
      y: 100

    settings:
      ui:
        position:
          x: 650
          y: 100

  - id: "image-watermark"
    type: "image-composite"
    name: "Add Watermark"
    category: "media"
    version: "1.0.0"

    metadata:
      id: "image-composite"
      name: "Image Composite"
      type: "image-composite"
      version: "1.0.0"
      author: "Atomiton Core Team"
      description: "Image processing and manipulation"
      category: "media"
      icon: "image"
      source: "system"
      experimental: false
      deprecated: false

    inputPorts:
      - id: "input"
        name: "Input"
        type: "input"
        dataType: "buffer"
        required: true

    outputPorts:
      - id: "output"
        name: "Output"
        type: "output"
        dataType: "buffer"
      - id: "metadata"
        name: "Metadata"
        type: "output"
        dataType: "object"

    parameters:
      operation:
        type: "string"
        default: "resize"
        control: "select"
        options: ["resize", "crop", "rotate", "flip", "watermark", "filter"]
      watermarkPath:
        type: "string"
        control: "file-picker"
        fileTypes: [".png", ".jpg", ".svg"]
      position:
        type: "string"
        default: "bottom-right"
        control: "select"
        options: ["top-left", "top-right", "bottom-left", "bottom-right", "center"]
      opacity:
        type: "number"
        default: 0.7
        control: "range"
        min: 0
        max: 1
        step: 0.1
      scale:
        type: "number"
        default: 0.25
        control: "range"
        min: 0.1
        max: 1
        step: 0.05
      margin:
        type: "number"
        default: 10
        control: "number"

    data:
      operation: "watermark"
      watermarkPath: "/assets/watermark.png"
      position: "bottom-right"
      opacity: 0.7
      scale: 0.25
      margin: 10
      customLabel: "Add Watermark"
      lastModified: "2025-01-15T10:00:00Z"

    position:
      x: 650
      y: 200

    settings:
      ui:
        position:
          x: 650
          y: 200

  - id: "save-processed"
    type: "file-system"
    name: "Save Processed Image"
    category: "io"
    version: "1.0.0"

    metadata:
      id: "file-system"
      name: "File System"
      type: "file-system"
      version: "1.0.0"
      author: "Atomiton Core Team"
      description: "File system operations (read, write, list)"
      category: "io"
      icon: "file"
      source: "system"
      experimental: false
      deprecated: false

    inputPorts:
      - id: "input"
        name: "Input"
        type: "input"
        dataType: "any"
        required: true

    outputPorts:
      - id: "output"
        name: "Output"
        type: "output"
        dataType: "any"
      - id: "error"
        name: "Error"
        type: "error"
        dataType: "object"

    parameters:
      operation:
        type: "string"
        default: "read"
        control: "select"
        options: ["read", "write", "list", "delete", "exists"]
      filePath:
        type: "string"
        required: true
        control: "file-picker"
      createDirectory:
        type: "boolean"
        default: false
        control: "checkbox"
      overwrite:
        type: "boolean"
        default: true
        control: "checkbox"

    data:
      operation: "write"
      filePath: "/images/output"
      createDirectory: true
      overwrite: true
      customLabel: "Save Processed Image"
      lastModified: "2025-01-15T10:00:00Z"

    position:
      x: 900
      y: 150

    settings:
      ui:
        position:
          x: 900
          y: 150

edges:
  - id: "source-to-loop"
    source: "image-source"
    target: "image-loop"
    sourceHandle: "output"
    targetHandle: "input"

  - id: "loop-to-parallel"
    source: "image-loop"
    target: "parallel-processor"
    sourceHandle: "item"
    targetHandle: "input"

  - id: "parallel-to-resize"
    source: "parallel-processor"
    target: "image-resize"
    sourceHandle: "output"
    targetHandle: "input"

  - id: "resize-to-watermark"
    source: "image-resize"
    target: "image-watermark"
    sourceHandle: "output"
    targetHandle: "input"

  - id: "watermark-to-save"
    source: "image-watermark"
    target: "save-processed"
    sourceHandle: "output"
    targetHandle: "input"

variables:
  inputFolder:
    type: "string"
    defaultValue: "/images/input"
    description: "Path to input images folder"
  outputFolder:
    type: "string"
    defaultValue: "/images/output"
    description: "Path to output images folder"
  concurrency:
    type: "number"
    defaultValue: 4
    description: "Number of parallel processing threads"

settings:
  runtime:
    timeout: 60000
    parallel: true
  ui:
    color: "#9C27B0"